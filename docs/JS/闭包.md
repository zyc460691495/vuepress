---
date: 2025-12-27
lang: zh-CN
title: 函数闭包
description:
---

### 变量作用域

后面一个实例中， a是一个全局变量。 在web页面中全局变量属于`window`对象。
全局变量可应用于页面上的所有脚本。
在第一个实例中， a 是一个局部变量。
局部变量只能用于定义它函数内部。对于其他的函数或脚本代码是不可用的。
全局和局部变量即便名称相同，它们也是两个不同的变量。修改其中一个，不会影响另一个的值。
> 变量声明时如果不使用 var 关键字，那么它就是一个全局变量，即便它在函数内定义。

```js
function myFunction() {
    var a = 4;
    return a * a;
}

var a = 4;

function myFunction() {
    return a * a;
}
```

### 内嵌函数
在 JavaScript 中，所有函数都能访问它们上一层的作用域。
```js
// add是一个函数，这个函数的返回值是 counter += 1
const add = (() => {
    let counter = 0;
    return () => counter += 1
})();

console.log(add()) // add = () =>  1, count = 1
console.log(add()) // add = () =>  2, count = 3
console.log(add()) // add = () =>  3, count = 4
```



```js
for (var i = 0; i < 5; i++) {
    setTimeout(function () {
        console.log(i++);
    }, 4000)
}
console.log(i);
// 5
// 5
// 6
// 7
// 8
// 9
```

```js
for (var i = 0; i < 5; i++) {
    (function (x) {
        setTimeout(function () {
            console.log(x++);
        }, 4000)
    })(i);
}
console.log(i);
// 5
// 0
// 1
// 2
// 3
// 4
```